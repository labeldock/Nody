<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=2">
  <title>Command Zone</title>
  <link rel="stylesheet" href="../../TEST/test_source/nody.css">
</head>
<body>
	<div id="header">
		<nav>
			<menu>
				<a href="javascript:;" loadpage="appear">appear</a>
				<a href="javascript:;" loadpage="mvvm">mvvm</a>
			</menu>
		</nav>
	</div>
	<div id="main">
		<div id="main-container"></div>
	</div>
	<script src="../../js/nody.js"></script>
	<script>
	var menuContext = new Contexts("#header menu","a");
	
	var loader = new Loader("#main-container",{
		"appear":"subview/appear.html",
		"mvvm":"subview/mvvm.html"
	});
	
	menuContext.onSelects("click",function(){
		var pagename = ELATTR(this,"loadpage");
		if(pagename) loader.open(pagename);
	});
	
	loader.setLoadCompleteEvent("mvvm",function(a,b,c){
		
	    var data = {"root":"hello","list":[
	    	{title:"카드이름1",description:"첫번째 카드입니다",list:[{title:"별명1"},{title:"별명2"},{title:"별명3"}]},
	  		{title:"카드이름2",description:"두번째 카드입니다",list:[{title:"별명4"},{title:"별명5"},{title:"별명6"}]},
			{title:"카드이름3",description:"세번째 카드입니다",list:[{title:"별명7"},{title:"별명9"},{title:"별명10"}]}
	    ]};
		
		//데이터를 불러거나 다시 출력하는 역활
	    var dataContext = new DataContext(data,"list");
		
		//뷰를 그리는 방법을 정의
	    var viewModel = new ViewModel(
	  	  function(context,childNodes){
	  		  return MAKE("div.inline-box",context.bind("title","input"),context.action("delete","button::delete"));
	  	  },
	  	  function(context,childNodes){
	  		  return MAKE("li",
	  		  	MAKE("table",
	  				MAKE("tbody",
	  					MAKE("tr",
	  						MAKE("td",
	  							MAKE("div.inline-box",
	  	  						  MAKE("p",context.bind("title","p")),
	  	  						  context.action("up","button::up"),
	  	  						  context.action("down","button::down"),
	  	  						  context.action("append","button::append",{title:"별명99"})
	  						  )
	  						),
	  						MAKE("td",
	  							childNodes
	  						)
	  					)
	  				)
	  	  		)
	  	  	  );
	  	  },
	  	  function(context,childNodes){
	  		  return MAKE("ul",childNodes);
	  	  }
	    );
		//뷰를 그리고 이벤트를 등록함
	    var listViewController = new DataContextViewController("#listContainer",dataContext.getRootManagedData(),viewModel);
	    listViewController.needDisplay();
	});
	</script>
</body>
</html>